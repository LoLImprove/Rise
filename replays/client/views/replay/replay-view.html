<template name="ReplayView">
  <div class="rise-replay-header">
    <h2>{{ > generalMeta meta_information.general }}</h2>
    <strong class="replay-match-result">{{ upcase victory }}</strong>
  </div>

  <div class="rise-replay-container">
    {{ > RisePlayer video_id }}
  </div>
  <div class="replay-data">
    {{ #with user }}
      <div class="replay-user-information">
        <img {{ profile.avatar }}>
        <h3>{{ username }}</h3>
        {{ > userMeta profile }}
      </div>
    {{ /with }}

    <div class="replay-description">
      <span class="description slideDown closed">
        {{ description }}
      </span>
      {{ #if shortDescription }} <!-- Bit useless -->
        <button class="more">More...</button>
      {{ else }}
        <button class="less">Less...</button>
      {{ /if }}
    </div>

    <div class="replay-information">
      <ul>
        {{ > specificMeta meta_information.specific }}
        <li>{{duration}}</li>
        <li>{{patch}}</li>
      </ul>
    </div>

    <div class="replay-toolbar">
      {{ #if currentUser }}
        {{ #isNotOwnerOf this }}
          {{ #if $or isAnalyzing isEditing }}
            <button class="edit-general-note">Add a general note</button>
            <button class="add-timeline-entry">Add an entry to timeline</button>
          {{ else }}
            {{ #if currentUserAnalysis }}
              <button class="edit-analysis">Improve your analysis !</button>
            {{ else }}
              <button class="start-analysis">Analyse !</button>
            {{ /if }}
          {{ /if }}
        {{ /isNotOwnerOf }}
      {{ /if }}

      <ul>
        {{ #if replay_file }}
          <li><a href="{{ replay_file }}">Download LPR</a></li>
        {{/if}}
        <li><a href="#">Report</a></li>
        {{ #isOwnerOf this }}
          <li><a href="#" class="edit-replay">Edit</a></li>
        {{ /isOwnerOf }}
      </ul>
    </div>

  </div>
</template>
